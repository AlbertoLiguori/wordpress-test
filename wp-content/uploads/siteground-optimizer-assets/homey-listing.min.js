jQuery(document).ready(function(a){"use strict";var l,b,ai,k,n,j,G,ag,aC,c,aF,aE,ac,o,t,ab,aD,aH,_,Z,Y,X,W,V,S,R,aa,O,N,aj,L,K,$,I,J,aB,aA,M,ak,az,ay,Q,i,h,T,U,aq,d,m,e,E,r,A,u,w,af,v,ah,f,q,H,x,an,ao,ap,at,au,av,z,y,B,C,F,s,P,p,ad,ae;if(typeof Homey_Listing!="undefined"){l={},l.isMobile=/(Android|BlackBerry|iPhone|iPad|Palm|Symbian|Opera Mini|IEMobile|webOS)/.test(navigator.userAgent),l.isAndroid=/(Android)/.test(navigator.userAgent),l.isiOS=/(iPhone|iPod|iPad)/.test(navigator.userAgent),l.isiPhone=/(iPhone|iPod)/.test(navigator.userAgent),l.isiPad=/(iPad|iPod)/.test(navigator.userAgent),b=Homey_Listing.ajaxURL,ai=Homey_Listing.homey_booking_type,k=Homey_Listing.are_you_sure_text,n=Homey_Listing.delete_btn_text,j=Homey_Listing.cancel_btn_text,G=Homey_Listing.confirm_btn_text,ag=Homey_Listing.edit_tab,aC=Homey_Listing.process_loader_refresh,c=Homey_Listing.process_loader_spinner,aF=Homey_Listing.process_loader_circle,aE=Homey_Listing.process_loader_cog,ac=Homey_Listing.btn_save,o=Homey_Listing.success_icon,t=Homey_Listing.verify_nonce,ab=Homey_Listing.verify_file_type,aD=Homey_Listing.add_listing_msg,aH=Homey_Listing.processing_text,_=Homey_Listing.acc_bedroom_name,Z=Homey_Listing.acc_bedroom_name_plac,Y=Homey_Listing.acc_guests,X=Homey_Listing.acc_guests_plac,W=Homey_Listing.acc_no_of_beds,V=Homey_Listing.acc_no_of_beds_plac,S=Homey_Listing.acc_bedroom_type,R=Homey_Listing.acc_bedroom_type_plac,aa=Homey_Listing.acc_btn_remove_room,O=Homey_Listing.service_name,N=Homey_Listing.service_name_plac,aj=Homey_Listing.service_price,L=Homey_Listing.service_price_plac,K=Homey_Listing.service_des,$=Homey_Listing.service_des_plac,I=Homey_Listing.btn_remove_service,J=Homey_Listing.pricing_link,aB=Homey_Listing.calendar_link,aA=Homey_Listing.geo_coding,M=Homey_Listing.avail_label,ak=Homey_Listing.unavail_label,az=Homey_Listing.geo_country_limit,ay=Homey_Listing.geocomplete_country,Q=Homey_Listing.homey_is_rtl,i=Homey_Listing.booked_hours_array,h=Homey_Listing.pending_hours_array,T=Homey_Listing.booking_start_hour,U=Homey_Listing.booking_end_hour,i!==''&&i.length!==0&&(i=JSON.parse(i)),h!==''&&h.length!==0&&(h=JSON.parse(h)),setInterval(function(){a("select").each(function(b){a(this).hasClass('error')?a("label[for='"+a(this).attr('id')+"']").addClass("select_input_error"):a("label[for='"+a(this).attr('id')+"']").removeClass("select_input_error")})},500);function ax(d,e){var a,b,c;for(d=encodeURI(d),e=encodeURI(e),a=document.location.search.substr(1).split('&'),b=a.length;b--;)if(c=a[b].split('='),c[0]==d){c[1]=e,a[b]=c.join('=');break}b<0&&(a[a.length]=[d,e].join('=')),document.location.search=a.join('&')}a('#homey_listing_mode').on('change',function(){var b='mode',c=a(this).val();ax(b,c)});function al(a){return parseInt(a,10)}a('#form_tabs li').on('click',function(){a('#media-tab').addClass('tab-pane'),a(this).hasClass('smb-media')?(a('#media-tab').css('visibility','visible'),a('#media-tab').css('height','auto'),a('#media-tab').css('position','unset'),a('#media-tab').css('display','block')):(a('#media-tab').css('visibility','hidden'),a('#media-tab').css('height','0'),a('#media-tab').css('position','absolute'),a('#media-tab').css('display','none'))});function aw(){var j=new Date,f=[],g=[],d,c,e,b,k,l,m;for(d in i)i.hasOwnProperty(d)&&d!==''&&(c=[],c.title=Homey_Listing.hc_reserved_label,c.start=moment.unix(d).utc().format(),c.end=moment.unix(i[d]).utc().format(),c.editable=!1,c.color='#fdd2d2',c.textColor='#444444',f.push(c));for(e in h)h.hasOwnProperty(e)&&e!==''&&(b=[],b.title=Homey_Listing.hc_pending_label,b.start=moment.unix(e).utc().format(),b.end=moment.unix(h[e]).utc().format(),b.editable=!1,b.color='#ffeedb',b.textColor='#333333',g.push(b));k=a.merge(f,g),l=document.getElementById('homey_hourly_calendar_edit_listing'),m=new FullCalendar.Calendar(l,{locale:Homey_Listing.homey_current_lang,timeZone:Homey_Listing.homey_timezone,plugins:['timeGrid'],defaultView:'timeGridWeek',slotDuration:'00:30:00',minTime:T,maxTime:U,events:k,defaultDate:j,selectHelper:!0,selectOverlap:!1,footer:!1,nowIndicator:!0,allDayText:Homey_Listing.hc_hours_label,weekNumbers:!1,weekNumbersWithinDays:!0,weekNumberCalculation:'ISO',editable:!1,eventLimit:!0,unselectAuto:!1,isRTL:Q,buttonText:{today:Homey_Listing.hc_today_label}}),m.render()}ai=='per_hour'&&document.getElementById('homey_hourly_calendar_edit_listing')&&(aw(),a('ul#form_tabs li').on('click',function(b){b.preventDefault(),a(this).hasClass('calendar-js')?(a('#calendar-tab').css('display','block'),a('#calendar-tab').css('visibility','visible')):(a('#calendar-tab').css('display','none'),a('#calendar-tab').css('visibility','hidden'))})),a("#cus_night_price").on('keyup',function(){a("#cus_night_price").removeClass('error')}),a('#cus_btn_save').on('click',function(k){var d,g,h,e,i,f,j;k.preventDefault(),d=a(this),g=a('#cus_start_date').val(),h=a('#cus_end_date').val(),e=a('#cus_night_price').val(),i=a('#cus_additional_guest_price').val(),f=a('#cus_weekend_price').val(),j=a('#listing_id_for_custom').val(),a.trim(e)!=''?a.ajax({type:'post',url:b,dataType:'json',data:{action:'homey_add_custom_period',start_date:g,end_date:h,night_price:e,additional_guest_price:i,weekend_price:f,listing_id:j},beforeSend:function(){d.children('i').remove(),d.prepend('<i class="fa-left '+c+'"></i>')},success:function(a){a.success?window.location.href=J:alert(a.message)},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)},complete:function(){d.children('i').removeClass(c)}}):(a("#cus_night_price").focus(),a("#cus_night_price").addClass('error'))}),a('.homey_delete_period').on('click',function(h){var d,e,f,g;h.preventDefault(),d=a(this),e=d.data('startdate'),f=d.data('enddate'),g=d.data('listingid'),a.ajax({type:'post',url:b,dataType:'json',data:{action:'homey_delete_custom_period',start_date:e,end_date:f,listing_id:g},beforeSend:function(){d.children('i').remove(),d.prepend('<i class="fa-left '+c+'"></i>')},success:function(a){a.success?d.parents('tr').remove():alert(a.message)},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)},complete:function(){d.children('i').removeClass(c)}})}),aq=function(a){return a!=0},a('ul#form_tabs li').on('click',function(b){b.preventDefault();var c=a(this).data('tab');a('#current_tab').val(c)}),a("[data-hide]").on("click",function(){a(this).closest("."+a(this).attr("data-hide")).hide()}),d=1,m=a("#submit_listing_form"),e=a(".form-step"),E=a(".form-step-gal"),r=a(".btn-step-next"),A=a(".btn-step-back"),u=a(".btn-step-submit"),w=u.find("button[type='submit']"),af=a('#total-steps'),v=a('#step-counter'),ah=a('.steps-breadcrumb li'),f=a(".validate-errors"),q=a(".validate-errors-gal"),H=a(".listing-thumb"),af.html(e.length),v.html(d),e.not(':eq(0), .form-step-gal1').hide(),e.eq(0).addClass('active'),D(d),a('ul#form_tabs li, .btn-save-listing').on('click',function(){var b=a('#form_tabs li.active').index();m.valid()?f.hide():(a("html, body").animate({scrollTop:0},"slow"),setTimeout(function(){a('#form_tabs li, .tab-content div').removeClass('active in'),a('#form_tabs li a').attr('aria-expanded','false'),a('#form_tabs li').eq(b).addClass('active'),a('#form_tabs li a').attr('aria-expanded','true'),a('.tab-content .tab-pane').eq(b).addClass('active in')},200),f.show())}),r.on('click',function(b){if(a(".form-step-gal1").hasClass('active'))if(a(".upload-gallery-thumb").length<1)return a("#homey_gallery_dragDrop").css("border","3px dashed red"),b.preventDefault(),!1;if(a("html, body").animate({scrollTop:0},"slow"),l.isiOS&&y(),d<e.length){if(a(E).is(':visible')){if(!a(H).length>0){q.show();return}q.hide()}d>0&&(e.removeClass('active').css({display:'none'}),e.eq(d-1).addClass('active').css({display:'block'})),m.valid()?(e.removeClass('active').css({display:'none'}),e.eq(d++).addClass('active').css({display:'block'}),a('.form-step-gal1').css('visibility','visible'),a('.form-step-gal1').css('height','auto'),f.hide()):f.show()}D(d),v.html(d)}),A.on('click',function(){a("html, body").animate({scrollTop:0},"slow"),d>1&&(d=d-2,d<e.length&&(e.show(),e.not(':eq('+d+++')').hide(),ah.eq(d).removeClass('active'))),D(d),v.html(d)}),w.on('click',function(b){if(b.preventDefault(),a(E).is(':visible')){if(!a(H).length>0){q.show();return}q.hide()}m.valid()?(f.hide(),w.attr('disabled',!0)):(f.show(),a("html, body").animate({scrollTop:0},"slow"))}),m.length>0&&m.validate({ignore:":hidden:not(.form-step.active .selectpicker)",errorPlacement:function(a,b){return!1},rules:{night_price:{number:!0}},submitHandler:function(a){u.attr("disabled",!0),a.submit()}});function D(b){var c=al(e.length);a(".action").hide(),b<c&&r.show(),b>1&&A.show(),b===c&&(r.hide(),u.show())}a(window).load(function(){ag!='media'&&a('.form-step-gal1, #media-tab').css('display','none')}),a('#invoice-print-button').length>0&&a('#invoice-print-button').on('click',function(e){e.preventDefault();var d,c;d=a(this).attr('data-id'),c=window.open('','Print Me','width=700 ,height=842'),a.ajax({type:'POST',url:b,data:{action:'homey_create_invoice_print',invoice_id:d},success:function(a){c.document.write(a),c.document.close(),c.focus()},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)}})}),a('#invoice_status, #invoice_type').on('change',function(){x()}),a('#startDate, #endDate').on('change',function(){var b=a('#startDate').val(),c=a('#endDate').val();if(b==''||c=='')return;x()}),x=function(){var c=a('#invoice_status').val(),d=a('#invoice_type').val(),e=a('#startDate').val(),f=a('#endDate').val();a.ajax({url:b,dataType:'json',type:'POST',data:{action:'homey_invoices_ajax_search',invoice_status:c,invoice_type:d,startDate:e,endDate:f},beforeSend:function(){a('#homey-map-loading').show(),a('.pagination').hide(),a('#invoices_content').empty().append('<div id="homey-map-loading"><div class="mapPlaceholder"><div class="loader-ripple spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div></div>')},success:function(b){b.success&&(a('#invoices_content').empty().append(b.result),a('#invoices_total_price').empty().append(b.total_price),a('.pagination').hide())},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)}})},a('#printReservation').length>0&&a('#printReservation').on('click',function(e){e.preventDefault();var d,c;d=a(this).attr('data-resvID'),c=window.open('','Print Me','width=700 ,height=842'),a.ajax({type:'POST',url:b,data:{action:'homey_create_reservation_print',reservation_id:d},success:function(a){c.document.write(a),c.document.close(),c.focus()},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)}})}),an=a("#listing_title"),ao=a("#property-title-fill"),ap=null;function g(b,c){a(b).on("keyup",function(d){if(a(b).attr("name")==="night_price")if(!a.isNumeric(a(b).val()))return;if(a(b).attr("name")==="listing_bedrooms"||a(b).attr("name")==="guests"||a(b).attr("name")==="baths")if(!a.isNumeric(a(b).val()))return;var e=d.target.value;a(c).html(e)})}g("#listing_title","#title-place"),g("#listing_address","#address-place"),g("#day_date_price","#price-place"),g("#night_price","#price-place"),g("#price_postfix","#price-postfix"),g("#hour_price","#price-place"),g("#listing_bedrooms","#total-beds"),g("#guests","#total-guests"),g("#baths","#total-baths");function ar(b,c,d){a(b).on('change',function(){var b;d=='yes'?(b=a(this).find("option:selected").text()):(b=a(this).find("option:selected").val()),a(c).html(b)})}ar("#listing_type","#listing-type-view",'yes'),a('.delete-listing').on('click',function(){var c=a(this),d=c.data('id'),e=c.data('nonce');return bootbox.confirm({message:"<p><strong>"+k+"</strong></p>",buttons:{confirm:{label:n,className:'btn btn-primary btn-half-width'},cancel:{label:j,className:'btn btn-grey-outlined btn-half-width'}},callback:function(f){f==!0&&a.ajax({type:'POST',dataType:'json',url:b,data:{action:'homey_delete_listing',listing_id:d,security:e},beforeSend:function(){c.find('i').removeClass('fa-trash'),c.find('i').addClass('fa-spin fa-spinner')},success:function(a){a.success==!0?window.location.reload():(jQuery('#homey_modal').modal('hide'),alert(a.reason))},error:function(a){}})}}),!1}),a('.membership-featured-js').on('click',function(f){var c,d,e;return f.preventDefault(),c=a(this),d=c.data('id'),e=c.data('nonce'),bootbox.confirm({message:"<p><strong>"+k+"</strong></p>",buttons:{confirm:{label:G,className:'btn btn-primary btn-half-width'},cancel:{label:j,className:'btn btn-grey-outlined btn-half-width'}},callback:function(f){f==!0&&a.ajax({type:'POST',dataType:'json',url:b,data:{action:'homey_membership_featured_listing',listing_id:d,security:e},beforeSend:function(){c.find('i').removeClass('fa-star-o'),c.find('i').addClass('fa-spin fa-spinner')},success:function(a){a.success==!0?window.location.reload():(c.find('i').removeClass('fa-spin fa-spinner'),c.find('i').addClass('fa-star-o'),jQuery('#homey_modal').modal('hide'),alert(a.reason))},error:function(a){}})}}),!1}),a('.reservation-delete').on('click',function(){var c=a(this),d=c.data('id');return bootbox.confirm({message:"<p><strong>"+k+"</strong></p>",buttons:{confirm:{label:n,className:'btn btn-primary btn-half-width'},cancel:{label:j,className:'btn btn-grey-outlined btn-half-width'}},callback:function(e){e==!0&&a.ajax({type:'POST',dataType:'json',url:b,data:{action:'homey_reservation_del',reservation_id:d},beforeSend:function(){c.find('i').removeClass('fa-trash'),c.find('i').addClass('fa-spin fa-spinner')},success:function(a){a.success==!0?window.location.href=a.url:(jQuery('#homey_modal').modal('hide'),alert(a.reason))},error:function(a){}})}}),!1}),a('.mark-as-paid').on('click',function(){var c=a(this),d=c.data('id');return bootbox.confirm({message:"<p><strong>"+k+"</strong></p>",buttons:{confirm:{label:G,className:'btn btn-primary btn-half-width'},cancel:{label:j,className:'btn btn-grey-outlined btn-half-width'}},callback:function(e){e==!0&&a.ajax({type:'POST',dataType:'json',url:b,data:{action:'homey_reservation_mark_paid',reservation_id:d},beforeSend:function(){c.find('i').removeClass('fa-money'),c.find('i').addClass('fa-spin fa-spinner')},success:function(a){a.success==!0?window.location.reload():(jQuery('#homey_modal').modal('hide'),alert(a.reason))},error:function(a){}})}}),!1}),a('.put_on_hold').on('click',function(){var c=a(this),d=c.data('id'),e=c.data('current');return a.ajax({type:'POST',dataType:'json',url:b,data:{action:'homey_put_hold_listing',listing_id:d,current_status:e},beforeSend:function(){c.find('i').removeClass('fa-pause'),c.find('i').addClass('fa-spin fa-spinner')},success:function(a){a.success==!0?window.location.reload():(jQuery('#homey_modal').modal('hide'),alert(a.reason))},error:function(a){}}),!1}),a('.start_thread_form').on('click',function(g){var d,e,f;g.preventDefault(),d=a(this),e=d.parents('form'),f=a('.messages-notification'),a.ajax({url:b,data:e.serialize(),method:e.attr('method'),dataType:"JSON",beforeSend:function(){d.children('i').remove(),d.prepend('<i class="fa-left '+c+'"></i>')},success:function(a){a.success?(f.empty().append(a.msg),e.find('input').val(''),e.find('textarea').val(''),window.location.replace(a.redirect_link)):f.empty().append(a.msg)},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)},complete:function(){d.children('i').removeClass(c)}})}),at=function(){a.ajax({url:b,data:{action:'houzez_chcek_messages_notifications'},method:"POST",dataType:"JSON",beforeSend:function(){},success:function(b){b.success&&(b.notification?(a('.user-alert').show(),a('.msg-alert').show()):(a('.user-alert').hide(),a('.msg-alert').hide()))}})},a('.start_thread_message_form').on('click',function(g){var d,e,f;g.preventDefault(),d=a(this),e=d.parents('form'),f=a('.messages-notification'),a.ajax({url:b,data:e.serialize(),method:e.attr('method'),dataType:"JSON",beforeSend:function(){d.children('i').remove(),d.prepend('<i class="fa-left '+c+'"></i>')},success:function(a){a.success?window.location.replace(a.url):f.empty().append(a.msg)},complete:function(){d.children('i').removeClass(c),d.children('i').addClass(o)}})}),a('.homey_delete_msg_thread').on('click',function(g){var c,d,e,f;g.preventDefault(),c=a(this),d=c.data('thread-id'),e=c.data('sender-id'),f=c.data('receiver-id'),bootbox.confirm({message:"<p><strong>"+k+"</strong></p>",buttons:{confirm:{label:n,className:'btn btn-primary btn-half-width'},cancel:{label:j,className:'btn btn-grey-outlined btn-half-width'}},callback:function(g){g==!0&&a.ajax({type:'POST',dataType:'json',url:b,data:{action:'homey_delete_message_thread',thread_id:d,sender_id:e,receiver_id:f},beforeSend:function(){c.find('i').removeClass('fa-trash'),c.find('i').addClass('fa-spin fa-spinner')},success:function(a){a.success==!0?window.location.reload():jQuery('#homey_modal').modal('hide')},error:function(a){}})}})}),a('.homey_delete_message').on('click',function(f){var c,d,e;f.preventDefault(),c=a(this),d=c.data('message-id'),e=c.data('created-by'),bootbox.confirm({message:"<p><strong>"+k+"</strong></p>",buttons:{confirm:{label:n,className:'btn btn-primary btn-half-width'},cancel:{label:j,className:'btn btn-grey-outlined btn-half-width'}},callback:function(f){f==!0&&a.ajax({type:'POST',dataType:'json',url:b,data:{action:'homey_delete_message',message_id:d,created_by:e},beforeSend:function(){c.find('i').removeClass('fa-trash'),c.find('i').addClass('fa-spin fa-spinner')},success:function(a){a.success==!0?window.location.reload():jQuery('#homey_modal').modal('hide')},error:function(a){}})}})}),au=function(a){var b='<div class="modal fade" id="homey_modal" tabindex="-1" role="dialog" aria-labelledby="faveModalLabel" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-body homey_messages_modal">'+a+'</div></div></div></div></div>';jQuery('body').append(b),jQuery('#homey_modal').modal()},av=function(){jQuery('#homey_modal').modal('hide')},z=function(){a('.icon-featured').on('click',function(f){var b,c,d,e;f.preventDefault(),b=jQuery(this),c=b.data('attachment-id'),d=b.data('thumb'),e=b.find('i'),a('.upload-view-media .media-image img').attr('src',d),a('.upload-gallery-thumb-buttons .featured_image_id').remove(),a('.upload-gallery-thumb-buttons .icon-featured i').removeClass('fa-star').addClass('fa-star-o'),b.closest('.upload-gallery-thumb-buttons').append('<input type="hidden" class="featured_image_id" name="featured_image_id" value="'+c+'">'),e.removeClass('fa-star-o').addClass('fa-star')}),a('.icon-delete').on('click',function(i){var c,e,f,g,h,d;i.preventDefault(),c=a(this),e=c.closest('.listing-thumb'),f=c.siblings('.icon-loader'),g=c.data('listing-id'),h=c.data('attachment-id'),f.show(),d=a.ajax({type:'post',url:b,dataType:'json',data:{action:'homey_remove_listing_thumbnail',listing_id:g,thumb_id:h,removeNonce:t}}),d.done(function(a){a.remove_attachment&&e.remove()}),d.fail(function(b,a){alert("Request failed: "+a)})})},z(),y=function(){a(document).keypress(function(b){if(a("#listing_title").length>0)if(b.which&&b.which===13||b.keyCode&&b.keyCode===13)return b.preventDefault(),!1}),a("#homey_gallery_container").sortable({placeholder:"sortable-placeholder"});var c=new plupload.Uploader({browse_button:'select_gallery_images',file_data_name:'listing_upload_file',container:'homey_gallery_dragDrop',drop_element:'homey_gallery_dragDrop',url:b+"?action=homey_listing_gallery_upload&verify_nonce="+t,filters:{mime_types:[{title:ab,extensions:"jpg,jpeg,gif,png"}],max_file_size:'10m',prevent_duplicates:!1}});c.init(),c.bind('FilesAdded',function(a,e){var d="",b='50';if(a.files.length>b){a.splice(b),alert('no more than '+b+' file(s)');return}plupload.each(e,function(a){d+='<div id="thumb-holder-'+a.id+'" class="col-sm-2 col-xs-4 listing-thumb">'+''+'</div>'}),document.getElementById('homey_gallery_container').innerHTML+=d,a.refresh(),c.start()}),c.bind('UploadProgress',function(b,a){document.getElementById("thumb-holder-"+a.id).innerHTML='<span>'+a.percent+"%</span>"}),c.bind('Error',function(b,a){document.getElementById('homey_errors').innerHTML+="<br/>Error #"+a.code+": "+a.message}),c.bind('FileUploaded',function(f,d,e){var b=a.parseJSON(e.response),c;b.success?(c='<figure class="upload-gallery-thumb"><img src="'+b.url+'" alt="thumb">'+'</figure>'+'<div class="upload-gallery-thumb-buttons">'+'<a class="icon-featured" data-thumb="'+b.thumb+'" data-listing-id="'+0+'"  data-attachment-id="'+b.attachment_id+'"><i class="fa fa-star-o"></i></a>'+'<button class="icon-delete" data-listing-id="'+0+'"  data-attachment-id="'+b.attachment_id+'"><i class="fa fa-trash-o"></i></button>'+'<input type="hidden" class="listing-image-id" name="listing_image_ids[]" value="'+b.attachment_id+'"/>'+'</div>'+'<span style="display: none;" class="icon icon-loader"><i class="fa fa-spinner fa-spin"></i></span>',document.getElementById("thumb-holder-"+d.id).innerHTML=c,z()):(c='<span class="error-message">'+b.reason+'</span>',document.getElementById("thumb-holder-"+d.id).innerHTML=c,console.log(b))})},y(),a('#add_more_bedrooms').on('click',function(d){var b,c;d.preventDefault(),b=a(this).data("increment")+1,a(this).data('increment',b),a(this).attr({"data-increment":b}),c='<div class="more_rooms_wrap"><div class="row"><div class="col-sm-6 col-xs-12"><div class="form-group"><label for="acc_bedroom_name">'+_+'</label>'+'<input type="text" name="homey_accomodation['+b+'][acc_bedroom_name]" class="form-control" placeholder="'+Z+'">'+'</div>'+'</div>'+'<div class="col-sm-6 col-xs-12">'+'<div class="form-group">'+'<label for="acc_guests">'+Y+'</label>'+'<input type="text" name="homey_accomodation['+b+'][acc_guests]" class="form-control" placeholder="'+X+'">'+'</div>'+'</div>'+'</div>'+'<div class="row">'+'<div class="col-sm-6 col-xs-12">'+'<div class="form-group">'+'<label for="acc_no_of_beds">'+W+'</label>'+'<input type="text" name="homey_accomodation['+b+'][acc_no_of_beds]" class="form-control" placeholder="'+V+'">'+'</div>'+'</div>'+'<div class="col-sm-6 col-xs-12">'+'<div class="form-group">'+'<label for="acc_bedroom_type">'+S+'</label>'+'<input type="text" name="homey_accomodation['+b+'][acc_bedroom_type]" class="form-control" placeholder="'+R+'">'+'</div>'+'</div>'+'</div>'+'<div class="row">'+'<div class="col-sm-12 col-xs-12">'+'<button type="button" data-remove="'+b+'" class="btn btn-primary remove-beds">'+aa+'</button>'+' </div>'+'</div>'+'<hr>';'</div>';a('#more_bedrooms_main').append(c),B()}),B=function(){a('.remove-beds').on('click',function(b){b.preventDefault();var c=a(this);c.closest('.more_rooms_wrap').remove()})},B(),a('#add_more_extra_services').on('click',function(d){var b,c;d.preventDefault(),b=a(this).data("increment")+1,a(this).data('increment',b),a(this).attr({"data-increment":b}),c='<div class="more_extra_services_wrap"><div class="row"><div class="col-sm-4 col-xs-12"><div class="form-group"><label for="name">'+Homey_Listing.ex_name+'</label>'+'<input type="text" name="extra_price['+b+'][name]" class="form-control" placeholder="'+Homey_Listing.ex_name_plac+'">'+'</div>'+'</div>'+'<div class="col-sm-4 col-xs-12">'+'<div class="form-group">'+'<label for="price"> '+Homey_Listing.ex_price+' </label>'+'<input type="text" name="extra_price['+b+'][price]" class="form-control" placeholder="'+Homey_Listing.ex_price_plac+'">'+'</div>'+'</div>'+'<div class="col-sm-4 col-xs-12">'+'<div class="form-group">'+'<label for="type"> '+Homey_Listing.ex_type+' </label>'+'<select name="extra_price['+b+'][type]" class="type-select-picker selectpicker" data-live-search="false" data-live-search-style="begins">'+'<option value="single_fee">'+Homey_Listing.ex_single_fee+'</option>'+'<option value="per_night"> '+Homey_Listing.ex_per_night+'</option>'+'<option value="per_guest">'+Homey_Listing.ex_per_guest+'</option>'+'<option value="per_night_per_guest">'+Homey_Listing.ex_per_night_per_guest+'</option>'+'</select>'+'</div>'+'</div>'+'</div>'+'<div class="row">'+'<div class="col-sm-12 col-xs-12">'+'<button type="button" data-remove="'+b+'" class="remove-extra-services btn btn-primary btn-slim">'+Homey_Listing.delete_btn_text+'</button>'+'</div>'+'</div>'+'</div>',a('#more_extra_services_main').append(c),a('.type-select-picker').selectpicker('refresh'),C()}),C=function(){a('.remove-extra-services').on('click',function(b){b.preventDefault();var c=a(this);c.closest('.more_extra_services_wrap').remove()})},C(),a('#add_more_service').on('click',function(d){var b,c;d.preventDefault(),b=a(this).data("increment")+1,a(this).data('increment',b),a(this).attr({"data-increment":b}),c='<div class="more_services_wrap"><div class="row"><div class="col-sm-6 col-xs-12"><div class="form-group"><label for="service_name">'+O+'</label>'+'<input type="text" name="homey_services['+b+'][service_name]" class="form-control" placeholder="'+N+'">'+'</div>'+'</div>'+'<div class="col-sm-6 col-xs-12">'+'<div class="form-group">'+'<label for="service_price">'+aj+'</label>'+'<input type="text" name="homey_services['+b+'][service_price]" class="form-control" placeholder="'+L+'">'+'</div>'+'</div>'+'</div>'+'<div class="row">'+'<div class="col-sm-12 col-xs-12">'+'<div class="form-group">'+'<label for="service_des">'+K+'</label>'+'<textarea placeholder="'+$+'" rows="3" name="homey_services['+b+'][service_des]" class="form-control"></textarea>'+'</div>'+'</div>'+'</div>'+'<div class="row">'+'<div class="col-sm-12 col-xs-12">'+'<button type="button" data-remove="'+b+'" class="btn btn-primary remove-service">'+I+'</button>'+' </div>'+'</div>'+'<hr>';'</div>';a('#more_services_main').append(c),F()}),F=function(){a('.remove-service').on('click',function(b){b.preventDefault();var c=a(this);c.closest('.more_services_wrap').remove()})},F(),s=function(){var c=new plupload.Uploader({browse_button:'thread-message-attachment',file_data_name:'messages_upload_file',container:'listing-thumbs-container',multi_selection:!0,url:b+"?action=homey_message_attacment_upload&verify_nonce="+t,filters:{max_file_size:'20m',prevent_duplicates:!0}});c.init(),c.bind('FilesAdded',function(a,e){var f='',d="",b='10';if(a.files.length>b){a.splice(b),alert('no more than '+b+' file(s)');return}plupload.each(e,function(a){d+='<li id="thumb-holder-'+a.id+'" class="listing-thumb">'+''+'</li>'}),document.getElementById('listing-thumbs-container').innerHTML+=d,a.refresh(),c.start()}),c.bind('UploadProgress',function(b,a){document.getElementById("thumb-holder-"+a.id).innerHTML='<li><lable>'+a.name+'<span>'+a.percent+"%</span></lable></li>"}),c.bind('Error',function(b,a){document.getElementById('errors-log').innerHTML+="<br/>Error #"+a.code+": "+a.message}),c.bind('FileUploaded',function(f,d,c){var b=a.parseJSON(c.response),e;b.success?(console.log(c),e='<div class="attach-icon delete-attachment"><i class="fa fa-trash remove-message-attachment" data-attachment-id="'+b.attachment_id+'"></i>'+'</div>'+'<span class="attach-text">'+b.file_name+'</span>'+'<input type="hidden" class="listing-image-id" name="listing_image_ids[]" value="'+b.attachment_id+'"/>',document.getElementById("thumb-holder-"+d.id).innerHTML=e,P(),s()):(console.log(b),alert('error'))}),c.refresh()},s(),P=function(){a('.remove-message-attachment').on('click',function(){var c=a(this),e=c.closest('li'),f=c.data('attachment-id'),d;c.removeClass('fa-trash'),c.addClass('fa-spinner'),d=a.ajax({type:'post',url:b,dataType:'json',data:{action:'homey_remove_message_attachment',thumbnail_id:f}}),d.done(function(a){a.attachment_remove&&e.remove(),s()}),d.fail(function(b,a){alert("Request failed: "+a)})})},a('#import_ical_feeds').on('click',function(h){var d,e,f,g;if(h.preventDefault(),d=a(this),e=[],f=[],g=a('input[name="listing_id"]').val(),a('.ical_feed_name').each(function(){e.push(a(this).val())}),a('.ical_feed_url').each(function(){f.push(a(this).val())}),e==''||f==''){alert(Homey_Listing.add_ical_feeds);return}a.ajax({url:b,method:'POST',dataType:"JSON",data:{action:'homey_add_ical_feeds',listing_id:g,ical_feed_name:e,ical_feed_url:f},beforeSend:function(){d.children('i').remove(),d.prepend('<i class="fa-left '+c+'"></i>')},success:function(a){a.success?window.location.href=a.url:d.children('i').remove(),alert(a.message)},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)},complete:function(){}})}),a('#add_more_feed').on('click',function(f){var b,c,d,e;if(f.preventDefault(),b=a('.enter_ical_feed_name').val(),c=a('.enter_ical_feed_url').val(),b==''||c==''){alert(Homey_Listing.both_required);return}d=a(this).data("increment")+1,a(this).data('increment',d),a(this).attr({"data-increment":d}),e='<div class="imported-calendar-row clearfix"><div class="imported-calendar-50"><input type="text" name="ical_feed_name[]" class="form-control ical_feed_name" value="'+b+'">'+'</div>'+'<div class="imported-calendar-50">'+'<input type="text" name="ical_feed_url[]" class="form-control ical_feed_url" value="'+c+'">'+'</div>';'</div>';a('#ical-feeds-container').append(e),p(),a('.ical-dummy').val('')}),p=function(){a('.remove-ical-feed').on('click',function(h){var d,e,f,g;h.preventDefault(),d=a(this),e=a('input[name="listing_id"]').val(),f=d.data('remove'),a.ajax({url:b,method:'POST',dataType:"JSON",data:{action:'homey_remove_ical_feeds',listing_id:e,remove_index:f},beforeSend:function(){d.children('i').remove(),d.prepend('<i class="fa-left '+c+'"></i>')},success:function(a){if(console.log(a.message),a.success){d.closest('.imported-calendar-row').remove();var b=setInterval(function(){window.location.reload(),clearInterval(b)},1e3)}},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)},complete:function(){d.children('i').removeClass(c)}}),g=a('#add_more_feed').data("increment"),a('#add_more_feed').attr({"data-increment":g-1})})},p(),a('#save_expenses').on('click',function(h){var d,e,f,g;if(h.preventDefault(),d=a(this),e=[],f=[],g=a('#expense_rsv_id').val(),a('.expense_name').each(function(){e.push(a(this).val())}),a('.expense_value').each(function(){f.push(a(this).val())}),e==''||f==''){alert(Homey_Listing.add_expense_msg);return}a.ajax({url:b,method:'POST',dataType:"JSON",data:{action:'homey_save_extra_expenses',reservation_id:g,expense_name:e,expense_value:f},beforeSend:function(){d.children('i').remove(),d.prepend('<i class="fa-left '+c+'"></i>')},success:function(a){a.success?window.location.href=a.url:(d.children('i').remove(),alert(a.message))},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)},complete:function(){d.children('i').removeClass(c)}})}),a('#add_more_expense').on('click',function(f){var b,c,d,e;if(f.preventDefault(),b=a('.enter_expense_name').val(),c=a('.enter_expense_value').val(),b==''||c==''){alert(Homey_Listing.both_required);return}d=a(this).data("increment")+1,a(this).data('increment',d),a(this).attr({"data-increment":d}),e='<div class="imported-calendar-row clearfix"><div class="imported-calendar-50"><input type="text" name="expense_name[]" class="form-control expense_name" value="'+b+'">'+'</div>'+'<div class="imported-calendar-50">'+'<input type="text" name="expense_value[]" class="form-control expense_value" value="'+c+'">'+'</div>';'</div>';a('#expenses-container').append(e),p(),a('.expense-dummy').val('')}),ad=function(){a('.remove-expense').on('click',function(h){var d,e,f,g;h.preventDefault(),d=a(this),e=a('#expense_rsv_id').val(),f=d.data('remove'),a.ajax({url:b,method:'POST',dataType:"JSON",data:{action:'homey_remove_extra_expense',reservation_id:e,remove_index:f},beforeSend:function(){d.children('i').remove(),d.prepend('<i class="fa-left '+c+'"></i>')},success:function(a){console.log(a.message),a.success&&(d.closest('.imported-calendar-row').remove(),window.location.reload())},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)},complete:function(){d.children('i').removeClass(c)}}),g=a('#add_more_expense').data("increment"),a('#add_more_expense').attr({"data-increment":g-1})})},ad(),a('#save_discounts').on('click',function(h){var d,e,f,g;if(h.preventDefault(),d=a(this),e=[],f=[],g=a('#expense_rsv_id').val(),a('.discount_name').each(function(){e.push(a(this).val())}),a('.discount_value').each(function(){f.push(a(this).val())}),e==''||f==''){alert(Homey_Listing.add_expense_msg);return}a.ajax({url:b,method:'POST',dataType:"JSON",data:{action:'homey_save_discounts',reservation_id:g,discount_name:e,discount_value:f},beforeSend:function(){d.children('i').remove(),d.prepend('<i class="fa-left '+c+'"></i>')},success:function(a){a.success?window.location.href=a.url:d.children('i').remove()},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)},complete:function(){}})}),a('#add_more_discount').on('click',function(f){var b,c,d,e;if(f.preventDefault(),b=a('.enter_discount_name').val(),c=a('.enter_discount_value').val(),b==''||c==''){alert(Homey_Listing.both_required);return}d=a(this).data("increment")+1,a(this).data('increment',d),a(this).attr({"data-increment":d}),e='<div class="imported-calendar-row clearfix"><div class="imported-calendar-50"><input type="text" name="discount_name[]" class="form-control discount_name" value="'+b+'">'+'</div>'+'<div class="imported-calendar-50">'+'<input type="text" name="discount_value[]" class="form-control discount_value" value="'+c+'">'+'</div>';'</div>';a('#discount-container').append(e),p(),a('.discount-dummy').val('')}),ae=function(){a('.remove-discount').on('click',function(h){var d,e,f,g;h.preventDefault(),d=a(this),e=a('#expense_rsv_id').val(),f=d.data('remove'),a.ajax({url:b,method:'POST',dataType:"JSON",data:{action:'homey_remove_discount',reservation_id:e,remove_index:f},beforeSend:function(){d.children('i').remove(),d.prepend('<i class="fa-left '+c+'"></i>')},success:function(a){console.log(a.message),a.success&&(d.closest('.imported-calendar-row').remove(),window.location.reload())},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)},complete:function(){d.children('i').removeClass(c)}}),g=a('#add_more_discount').data("increment"),a('#add_more_discount').attr({"data-increment":g-1})})},ae();function aG(){a('.available, .unavailable').on('click',function(){var d=a(this),e=d.data('formatted-date'),f=a('#period_listing_id').val();if(d.hasClass('past-day'))return;a.ajax({type:'post',url:b,dataType:'json',data:{action:'homey_make_date_unavaiable',selected_date:e,listing_id:f},beforeSend:function(){d.children('i').remove(),d.prepend('<i class="icon-center '+c+'"></i>')},success:function(a){a.success&&(a.message=='made_available'?(d.removeClass('unavailable'),d.addClass('available'),d.find('.day-status').text(M)):(d.removeClass('available'),d.addClass('unavailable'),d.find('.day-status').text(ak)))},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)},complete:function(){d.children('i').removeClass(c)}})})}aG(),a('.choose_payout_method').on('click',function(d){var c=a(this),b=c.val();b=='wire'?(a('#wire_transfer').show(),a('#paypal').hide(),a('#skrill').hide()):b=='paypal'?(a('#wire_transfer').hide(),a('#paypal').show(),a('#skrill').hide()):b=='skrill'&&(a('#wire_transfer').hide(),a('#paypal').hide(),a('#skrill').show())});function am(){var b=a("input[name='payout_method']:checked").val();b=='wire'?(a('#wire_transfer').show(),a('#paypal').hide(),a('#skrill').hide()):b=='paypal'?(a('#wire_transfer').hide(),a('#paypal').show(),a('#skrill').hide()):b=='skrill'&&(a('#wire_transfer').hide(),a('#paypal').hide(),a('#skrill').show())}jQuery('.choose_payout_method').length>0&&jQuery(window).load(function(){am()}),a('.define-payout-methods input').on('focusin',function(){a(this).removeClass('error')}),a('.homey_save_payout_method').on('click',function(e){e.preventDefault();var d=a(this);f.hide(),a('.date-saved-success').hide(),a.ajax({type:'post',url:b,dataType:'json',data:{action:'homey_save_payout_method_info',ben_first_name:a('#ben_first_name').val(),ben_last_name:a('#ben_last_name').val(),ben_company_name:a('#ben_company_name').val(),ben_tax_number:a('#ben_tax_number').val(),ben_street_address:a('#ben_street_address').val(),ben_apt_suit:a('#ben_apt_suit').val(),ben_city:a('#ben_city').val(),ben_state:a('#ben_state').val(),ben_zip_code:a('#ben_zip_code').val(),bank_account:a('#bank_account').val(),swift:a('#swift').val(),bank_name:a('#bank_name').val(),wir_street_address:a('#wir_street_address').val(),wir_aptsuit:a('#wir_aptsuit').val(),wir_city:a('#wir_city').val(),wir_state:a('#wir_state').val(),wir_zip_code:a('#wir_zip_code').val(),paypal_email:a('#paypal_email').val(),skrill_email:a('#skrill_email').val(),payout_method:a("input[name='payout_method']:checked").val(),security:a('#homey_payout_method_security').val()},beforeSend:function(){d.children('i').remove(),d.prepend('<i class="fa-left '+c+'"></i>')},success:function(d){var b,c;if(d.success)a('.date-saved-success').show();else{c=d.req;for(b=0;b<c.length;b++)a('#'+c[b]).addClass('error');f.show()}a("html, body").animate({scrollTop:0},"slow")},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)},complete:function(){d.children('i').remove()}})}),a('#homey_change_payout_status').on('click',function(d){d.preventDefault();var c=a(this);a.ajax({type:'post',url:b,dataType:'json',data:{action:'homey_update_payout_status',payout_status:a('#payout_status').val(),payout_id:a('#payout_id').val(),transfer_fee:a('#transfer_fee').val(),transfer_note:a('#transfer_note').val(),security:a('#homey_payout_status_security').val()},beforeSend:function(){c.empty(),c.html('<div class="spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>')},success:function(a){a.success?window.location.reload():(c.empty(),c.text(ac),alert(a.msg))},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)},complete:function(){}})}),a('#payout_status').on('change',function(){a(this).val()==3?a('.transfer_fee, .transfer_note').show():a('.transfer_fee, .transfer_note').hide()}),a(window).load(function(){var b=a("#payout_status").val();b==3?a('.transfer_fee, .transfer_note').show():a('.transfer_fee, .transfer_note').hide()}),a('#request_payout').on('click',function(g){var e,d,f;g.preventDefault(),e=a(this),d=a('#payout_alert'),f=a('#payout_alert span'),f.empty(),d.hide(),a.ajax({type:'post',url:b,dataType:'json',data:{action:'homey_add_payout',payout_amount:a('#payout_amount').val(),security:a('#homey_payout_request_security').val()},beforeSend:function(){e.children('i').remove(),e.prepend('<i class="fa-left '+c+'"></i>')},success:function(a){a.success?(d.show(),d.removeClass('alert-danger'),d.addClass('alert-success'),f.html(a.msg)):(d.show(),d.removeClass('alert-success'),d.addClass('alert-danger'),f.html(a.msg))},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)},complete:function(){e.children('i').remove()}})}),a('#btn_make_adjustment').on('click',function(g){var d,e,f;g.preventDefault(),d=a(this),e=d.parents('form'),f=e.find('.homey_messages'),a.ajax({url:b,data:e.serialize(),method:e.attr('method'),dataType:"JSON",beforeSend:function(){d.children('i').remove(),d.prepend('<i class="fa-left '+c+'"></i>')},success:function(a){a.success?window.location.reload():(f.empty().append(a.msg),d.children('i').removeClass(c))},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)},complete:function(){d.children('i').removeClass(c),d.children('i').addClass(o)}})}),a('#btn_guest_adjustment').on('click',function(g){var d,e,f;g.preventDefault(),d=a(this),e=d.parents('form'),f=e.find('.homey_messages'),a.ajax({url:b,data:e.serialize(),method:e.attr('method'),dataType:"JSON",beforeSend:function(){d.children('i').remove(),d.prepend('<i class="fa-left '+c+'"></i>')},success:function(a){a.success?window.location.reload():(f.empty().append(a.msg),d.children('i').removeClass(c))},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)},complete:function(){d.children('i').removeClass(c),d.children('i').addClass(o)}})}),a("#save_as_draft").click(function(){var e=a('#submit_listing_form'),d=a('#save_as_draft'),f=tinyMCE.get('description').getContent();a.ajax({type:'post',url:b,dataType:'json',data:e.serialize()+"&action=save_as_draft&description="+f,beforeSend:function(){d.children('i').remove(),d.prepend('<i class="fa-left '+c+'"></i>')},success:function(b){b.success&&(d.children('i').removeClass(c),d.children('i').addClass(o),a('input[name=draft_listing_id]').remove(),a('#submit_listing_form').prepend('<input type="hidden" name="draft_listing_id" value="'+b.listing_id+'">'))},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)}})}),a('#host_payment_option').on('change',function(){var b=a(this);b.val()=='percent'?a('.host-percentage').show():a('.host-percentage').hide()}),a('#save_host_payment_option').on('click',function(i){var e,g,h,d,f;i.preventDefault(),e=a(this),g=a('#host_payment_option').val(),h=a('#payment_percent').val(),d=a('#msg_alert'),f=a('#msg_alert span'),f.empty(),d.hide(),a.ajax({type:'post',url:b,dataType:'json',data:{action:'homey_add_host_payment_method',payment_type:g,percent:h},beforeSend:function(){e.children('i').remove(),e.prepend('<i class="fa-left '+c+'"></i>')},success:function(a){a.success?(d.show(),d.removeClass('alert-danger'),d.addClass('alert-success'),f.html(a.msg)):(d.show(),d.removeClass('alert-success'),d.addClass('alert-danger'),f.html(a.msg))},error:function(a,c,d){var b=eval("("+a.responseText+")");console.log(b.Message)},complete:function(){e.children('i').remove()}})})}})