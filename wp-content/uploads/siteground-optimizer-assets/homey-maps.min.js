(function(a){"use strict";var b,l,q,aM,aL,ag,ae,ab,ad,aK,aE,s,aV,ba,ac,aI,a$,a_,aZ,c,aY,d,M,aX,aW,N,B,C,D,E,F,H,k,I,J,K,y,o,O,Y,Q,R,S,T,U,V,W,X,G,Z,P,$,aU,aR,az,ax,w,af,av,ah,ai,aq,ap,v,aQ,z,aC,ak,aj,ar,at,an,x,aw,_,ay,e,t,A,aT,bb,r,h,j,g,n,i,m,f,p,aN,aO,aP,au,am,aD,al,aa,aA,aB,ao,aF,u,aG,aH,aJ,aS;typeof HOMEY_map_vars!="undefined"&&(l='',aL=HOMEY_map_vars.is_mapbox,ag=HOMEY_map_vars.api_mapbox,ae=HOMEY_map_vars.user_id,ab=a('#listings_found'),ad=HOMEY_map_vars.admin_url+'admin-ajax.php',aK=HOMEY_map_vars.header_map_city,aE=HOMEY_map_vars.markerPricePins,s=HOMEY_map_vars.pin_cluster,aV=HOMEY_map_vars.pin_cluster_icon,ba=HOMEY_map_vars.pin_cluster_zoom,ac=HOMEY_map_vars.is_singular_listing,aI=HOMEY_map_vars.homey_default_radius,a$=HOMEY_map_vars.geo_country_limit,a_=HOMEY_map_vars.geocomplete_country,aZ=null,c=0,aY=0,d=new Array,M=a('#homey_halfmap_listings_container'),aX=HOMEY_map_vars.default_lat,aW=HOMEY_map_vars.default_lng,N=HOMEY_map_vars.arrive,B=HOMEY_map_vars.depart,C=HOMEY_map_vars.guests,D=HOMEY_map_vars.pets,E=HOMEY_map_vars.search_country,F=HOMEY_map_vars.search_city,H=HOMEY_map_vars.search_area,k=HOMEY_map_vars.listing_type,I=HOMEY_map_vars.country,J=HOMEY_map_vars.state,K=HOMEY_map_vars.city,y=HOMEY_map_vars.area,o=HOMEY_map_vars.booking_type,O=HOMEY_map_vars.start_time,Y=HOMEY_map_vars.end_time,Q=HOMEY_map_vars.min_price,R=HOMEY_map_vars.max_price,S=HOMEY_map_vars.keyword,T=HOMEY_map_vars.lat,U=HOMEY_map_vars.lng,V=HOMEY_map_vars.radius,W=HOMEY_map_vars.bedrooms,X=HOMEY_map_vars.rooms,G=HOMEY_map_vars.room_size,y=HOMEY_map_vars.area,Z=HOMEY_map_vars.amenity,P=HOMEY_map_vars.facility,$=HOMEY_map_vars.not_found,aU=HOMEY_map_vars.infoboxClose,aR=HOMEY_map_vars.bedrooms_icon,az=HOMEY_map_vars.bathroom_icon,ax=HOMEY_map_vars.guests_icon,w=a('#securityhomeyMap').val(),af=0,av=HOMEY_ajax_vars.compare_url,ah=HOMEY_ajax_vars.add_compare,ai=HOMEY_ajax_vars.remove_compare,aq=HOMEY_ajax_vars.compare_limit,ap=!1,/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(ap=!0),v=function(){var a;return aL=='mapbox'&&ag!=''?(a=L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token='+ag,{attribution:'© <a href="https://www.mapbox.com/about/maps/">Mapbox</a> © <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/" target="_blank">Improve this map</a></strong>',tileSize:512,maxZoom:18,zoomOffset:-1,id:'mapbox/streets-v11',accessToken:'your.mapbox.access.token'})):(a=L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'})),a},aQ=function(){var a=homeyGetCookie('homey_compare_listings'),b=4;add_to_compare(av,ah,ai,aq,a,b),remove_from_compare(a,ah,ai)},z=function(){for(var a=0;a<d.length;a++)b.removeLayer(d[a]);d=[],q&&b.removeLayer(q)},aC=function(b){for(var c=[],a=0;a<b.length;a++)b[a].lat&&b[a].long&&c.push([b[a].lat,b[a].long]);return c},ak=function(b){a('#listing-mapzoomin').on('click',function(){var a=parseInt(b.getZoom(),10);console.log(a),a++,a>20&&(a=20),b.setZoom(a)})},aj=function(b){a('#listing-mapzoomout').on('click',function(){var a=parseInt(b.getZoom(),10);console.log(a),a--,a<0&&(a=0),b.setZoom(a)})},ar=function(a){for(c++,c>d.length&&(c=1);d[c-1].visible===!1;)c++,c>d.length&&(c=1);a.getZoom()<15&&a.setZoom(15),a.setView(d[c-1].getLatLng()),d[c-1]._icon||d[c-1].__parent.spiderfy(),a.setZoom(20),c-1==0||c-1==d.length?setTimeout(function(){d[c-1].fire('click')},500):d[c-1].fire('click')},at=function(a){for(c--,c<1&&(c=d.length);d[c-1].visible===!1;)c--,c>d.length&&(c=1);a.getZoom()<15&&a.setZoom(15),a.setView(d[c-1].getLatLng()),d[c-1]._icon||d[c-1].__parent.spiderfy(),a.setZoom(20),c-1==0||c==d.length?setTimeout(function(){d[c-1].fire('click')},500):d[c-1].fire('click')},a('#homey-gmap-next').on('click',function(){ar(b)}),a('#homey-gmap-prev').on('click',function(){at(b)}),an=function(a,g){var k=aC(a),c,b,e,h,f,t,i,l,m,n,o,p,r,j,u;1<=k.length&&g.fitBounds(k),s=='yes'&&(q=new L.MarkerClusterGroup({iconCreateFunction:function(a){var b=a.getAllChildMarkers(),c='<div class="homey-osm-cluster">'+b.length+'</div>';return L.divIcon({html:c,className:'mycluster',iconSize:L.point(47,47)})},spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0}));for(b=0;b<a.length;b++)a[b].lat&&a[b].long&&(e=a[b],h=L.latLng(e.lat,e.long),f={riseOnHover:!0},e.title&&(f.title=e.title),aE=='yes'?(t='<div  id="infobox_popup_'+a[b].id+'"  data-id="'+a[b].id+'" class="gm-marker gm-marker-color-'+a[b].term_id+'"><div class="gm-marker-price">'+a[b].price+'</div></div>',i=L.divIcon({className:'someclass',iconSize:new L.Point(0,0),html:t}),s=='yes'?c=new L.Marker(h,{icon:i}):c=L.marker(h,{icon:i}).addTo(g)):(l=a[b].icon,m=a[b].retinaIcon,l&&(n={iconUrl:l,iconSize:[44,56],iconAnchor:[20,57],popupAnchor:[1,-57]},m&&(n.iconRetinaUrl=m),f.icon=L.icon(n)),s=='yes'?c=new L.Marker(h,f):c=L.marker(h,f).addTo(g)),s=='yes'&&q.addLayer(c),o="",p="",r="",j='',a[b].bedrooms!=''&&(o='<li>'+aR+'<span class="total-beds">'+a[b].bedrooms+'</span></li>'),a[b].baths!=''&&(p='<li>'+az+'<span class="total-baths">'+a[b].baths+'</span></li>'),a[b].guests!=''&&(r='<li>'+ax+'<span class="total-guests">'+a[b].guests+'</span></li>'),a[b].listing_type!=''&&(j='<li class="item-type">'+a[b].listing_type+'</li>'),u='<div id="google-maps-info-window" class="homey-open-street-map"><div class="item-wrap item-grid-view"><div class="media property-item"><div class="media-left"><div class="item-media item-media-thumb"><a href="'+a[b].url+'" class="hover-effect">'+a[b].thumbnail+'</a>'+'<div class="item-media-price">'+'<span class="item-price">'+a[b].price+'</span>'+'</div>'+'</div>'+'</div>'+'<div class="media-body item-body clearfix">'+'<div class="item-title-head">'+'<div class="title-head-left">'+'<h2 class="title">'+'<a href="'+a[b].url+'">'+e.title+'</a></h2>'+'<address class="item-address">'+a[b].address+'</address>'+'</div>'+'</div>'+'<ul class="item-amenities">'+o+p+r+j+'</ul>'+'</div>'+'</div>'+'</div>'+'</div>',d.push(c),c.bindPopup(u));s=='yes'&&g.addLayer(q)},x=function(b,c,m,h,f,g,e,i,j,l){var d=a('#homey-halfmap'),n,p;N=b.find('input[name="arrive"]').val(),B=b.find('input[name="depart"]').val(),C=b.find('input[name="guest"]').val(),S=b.find('input[name="keyword"]').val(),D=b.find('input[name="pets"]:checked').val(),H=b.find('input[name="search_area"]').val(),F=b.find('input[name="search_city"]').val(),E=b.find('input[name="search_country"]').val(),T=b.find('input[name="lat"]').val(),U=b.find('input[name="lng"]').val(),V=b.find('input[name="radius"]').val(),o=b.find('input[name="booking_type"]').val(),k=b.find('select[name="listing_type"]').val(),I=b.find('select[name="country"]').val(),J=b.find('select[name="state"]').val(),K=b.find('select[name="city"]').val(),y=b.find('select[name="area"]').val(),O=b.find('select[name="start"]').val(),Y=b.find('select[name="end"]').val(),(k==""||k==void 0)&&(k=d.data('type')),(o==""||o==void 0)&&(o=d.data('booking_type')),Z=b.find('.amenities-list input[type=checkbox]:checked').map(function(c,b){return a(b).val()}).toArray(),P=b.find('.facilities-list input[type=checkbox]:checked').map(function(c,b){return a(b).val()}).toArray(),Q=b.find('select[name="min-price"]').val(),R=b.find('select[name="max-price"]').val(),W=b.find('select[name="bedrooms"]').val(),X=b.find('select[name="rooms"]').val(),G=b.find('select[name="room_size"]').val(),n=a('#sort_listings_halfmap').val(),c!=void 0&&(af=c),p='',r={action:'homey_half_map',arrive:N,depart:B,guest:C,keyword:S,pets:D,bedrooms:W,rooms:X,room_size:G,search_country:E,search_city:F,search_area:H,listing_type:k,'min-price':Q,'max-price':R,country:I,search_lat:T,search_lng:U,radius:V,state:J,city:K,area:y,booking_type:o,start_hour:O,end_hour:Y,amenity:Z,facility:P,sort_by:n,layout:al,num_posts:aa,paged:c,security:w},_(m,h,f,g,e,i,j,l,r,p)},aw=function(d,p,f,n){var g,h,i,e,k,l,c,o,j,m;document.getElementById(d)!=null?(f||(f=14),g='',h='',i='homey_sticky_map',e=L.latLng(g,h),k=!0,l={dragging:k,center:e,zoom:10,tap:!0},c=L.DomUtil.get(d),c!=null&&(c._leaflet_id=null),b=L.map(d,l),b.scrollWheelZoom.disable(),b.addLayer(v()),j={action:i,paged:n,security:w},m=function(c,d){a.ajax({url:c,dataType:"json",method:"POST",data:d,success:function(c){c.getListings===!0&&(z(),an(c.listings,b),a('#homey-map-loading').hide())},error:function(a){console.log(a)}})},m(ad,j),document.getElementById('listing-mapzoomin')&&ak(b),document.getElementById('listing-mapzoomout')&&aj(b)):console.log("No map element found")},_=function(t,s,f,x,u,e,m,c,q,l){var i,d,o,j,k,h,r,g,n,p;document.getElementById(f)!=null?(e||(e=14),m||(m=0),i='',c?d='homey_half_map':(d='homey_header_map',l=='lat_long'||l=='city'&&(i=aK)),o=L.latLng(t,s),j=!0,k={dragging:j,center:o,zoom:e,tap:!0},h=L.DomUtil.get(f),h!=null&&(h._leaflet_id=null),b=L.map(f,k),b.scrollWheelZoom.disable(),b.addLayer(v()),c?(g=q):(g={action:d,map_cities:i,security:w}),n=function(d,f){typeof f!="undefined"&&a.ajax({url:d,dataType:"json",method:"POST",data:f,beforeSend:function(){a('#homey-map-loading').show(),c&&M.empty().append('<div id="homey-map-loading"><div class="mapPlaceholder"><div class="loader-ripple spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div></div>')},success:function(f){f.getListings===!0?(z(),an(f.listings,b),c&&(M.empty().html(f.listingHtml),ab.empty().html(f.total_results),aJ()),homey_init_add_favorite(d,ae,ac),homey_init_remove_favorite(d,ae,ac),aQ(),c&&(ao(),a(".half-map-left-wrap, .half-map-right-wrap").animate({scrollTop:0},"slow")),a('#homey-map-loading').hide(),b.setZoom(e)):(z(),a('#homey-halfmap').append('<div class="map-notfound">'+$+'</div>'),M.empty().html('<div class="map-notfound">'+$+'</div>'),ab.empty().html(f.total_results),a(".loader-ripple").hide())},error:function(a){console.log(a)}})},n(ad,g),document.getElementById('listing-mapzoomin')&&ak(b),document.getElementById('listing-mapzoomout')&&aj(b),p=setInterval(function(){typeof a("#homey-gmap-prev")!="undefined",clearInterval(p)},1500)):console.log("No map element found")},ay=function(n,m,l,f,c,d,h,i){var e,a,j,k,g;f||(f=!1),c||(c=!1),d||(d=15),e={riseOnHover:!0},j=function(c){if(h){var b={iconUrl:h,iconSize:[44,56],iconAnchor:[20,57],popupAnchor:[1,-57]};i&&(b.iconRetinaUrl=i),e.icon=L.icon(b)}aM=L.marker(a,e).addTo(c)},k=function(b){var c=L.circle(a,200).addTo(b)},a=L.latLng(n,m),g=function(a){var e={dragging:f,center:a,zoom:d,tap:!1},g=document.getElementById(l);b=L.map(g,e),b.scrollWheelZoom.disable(),b.addLayer(v()),c||j(b),c&&k(b)},g(a)},a('#banner-map').length>0&&(e=a('#banner-map'),t=e.data('zoomlevel'),A=e.data('maptype'),aT=e.data('lat'),bb=e.data('long'),r=null,h='',j='',g="banner-map",n="infobox",i=!0,m=!1,f=t,p=0,_(h,j,g,n,i,f,p,m,r,A)),a('#homey-single-map').length>0&&(e=a('#homey-single-map'),t=e.data('zoom'),aN=e.data('pin-type'),aO=e.data('marker-pin'),aP=e.data('marker-pin-retina'),h=e.data('lat'),j=e.data('long'),g='homey-single-map',f=t,au=!1,aN=='marker'?(am=!1):(am=!0),ay(h,j,g,au,am,f,aO,aP)),a('#homey_sticky_map').length>0&&(e=a('#homey_sticky_map'),g='homey_sticky_map',f=12,i=!0,aD=e.data('mappaged'),aw(g,i,f,aD)),a('#homey-halfmap').length>0&&(e=a('#homey-halfmap'),t=e.data('zoom'),al=e.data('layout'),aa=e.data('num-posts'),aA=e.data('order'),aB=e.data('type'),o=e.data('booking_type'),A='',k==""&&(k=aB),h='',j='',g="homey-halfmap",n="infobox",i=!0,m=!0,f=t,p=0,r={action:'homey_half_map',arrive:N,depart:B,guest:C,keyword:S,pets:D,bedrooms:W,rooms:X,room_size:G,search_country:E,search_city:F,search_area:H,listing_type:k,'min-price':Q,'max-price':R,country:I,state:J,city:K,area:y,booking_type:o,search_lat:T,search_lng:U,radius:V,start_hour:O,end_hour:Y,amenity:Z,facility:P,layout:al,num_posts:aa,sort_by:aA,paged:af,security:w},_(h,j,g,n,i,f,p,m,r,A),a('.homey_half_map_search_btn').on('click',function(d){var b,c;d.preventDefault(),b=a(this).parents('.half-map-wrap'),c=1,x(b,c,h,j,g,n,i,f,p,m)}),a('#sort_listings_halfmap').on('change',function(d){var b,c;d.preventDefault(),b=a(this).parents('.half-map-wrap'),c=1,x(b,c,h,j,g,n,i,f,p,m)}),ao=function(){return a('.half_map_ajax_pagi a').on('click',function(d){var b,c;d.preventDefault(),b=a(this).data('homeypagi'),c=a(this).parents('.half-map-wrap'),x(c,b,h,j,g,n,i,f,p,m)}),!1},aF=function(b){a("#radius-range-slider").slider({value:b,min:0,max:100,step:1,slide:function(c,b){a("#radius-range-text").html(b.value),a("#radius-range-value").val(b.value)},stop:function(d,e){var b=a(this).parents('.half-map-wrap'),c=1;x(b,c,h,j,g,n,i,f,p,m)}}),a("#radius-range-text").html(a('#radius-range-slider').slider('value')),a("#radius-range-value").val(a('#radius-range-slider').slider('value'))},a("#radius-range-slider").length>0&&aF(aI)),a("input.input-search").length>0&&jQuery('input.input-search').autocomplete({source:function(b,a){jQuery.get('https://nominatim.openstreetmap.org/search',{format:'json',q:b.term,addressdetails:'1'},function(b){if(!b.length){a([{value:'',label:'there are no results'}]);return}a(b.map(function(a){var b={label:a.display_name,latitude:a.lat,longitude:a.lon,value:a.display_name};return typeof a.address!='undefined'&&(b.county=a.address.county),typeof a.address!='undefined'&&(b.city=a.address.city),typeof a.address!='undefined'&&(b.state=a.address.state),typeof a.address!='undefined'&&(b.country=a.address.country),typeof a.address!='undefined'&&(b.zip=a.address.postcode),typeof a.address!='undefined'&&(b.country_short=a.address.country_code),b})),jQuery("#ui-id-2").show()},'json')},select:function(c,b){a('input[name="lat"]').val(b.item.latitude),a('input[name="lng"]').val(b.item.longitude),a('input[name="search_area"]').attr('data-value',''),a('input[name="search_area"]').val(''),a('input[name="search_city"]').attr('data-value',b.item.city),a('input[name="search_city"]').val(b.item.city),a('input[name="search_country"]').attr('data-value',b.item.country),a('input[name="search_country"]').val(b.item.country),jQuery("#ui-id-2").hide()}}),u=function(c,d){var a=L.latLng(c,d),f=L.latLng(a),e;b.removeLayer(l),e={riseOnHover:!0,draggable:!0},l=L.marker(a,e).addTo(b)},aG=function(){var e,c,d,f,g,h;if(jQuery('#map').length===0)return;e=a('#map'),c=e.data('add-lat'),d=e.data('add-long'),(c===''||typeof c=='undefined')&&(c=25.68654),(d===''||typeof d=='undefined')&&(d=-80.431345),c=parseFloat(c),d=parseFloat(d),f=L.latLng(c,d),b=L.map('map',{center:f,zoom:15}),b.scrollWheelZoom.disable(),g=v(),b.addLayer(g),h={riseOnHover:!0,draggable:!0},l=L.marker(f,h).addTo(b),l.on('drag',function(a){document.getElementById('lat').value=l.getLatLng().lat,document.getElementById('lng').value=l.getLatLng().lng}),b.invalidateSize()},aG(),u=function(a,c){var d=L.latLng(a,c);l.setLatLng(d),b.invalidateSize(),b.panTo(new L.LatLng(a,c)),document.getElementById('lat').value=a,document.getElementById('lng').value=c},aH=function(){jQuery('#listing_address').autocomplete({source:function(b,a){jQuery.get('https://nominatim.openstreetmap.org/search',{format:'json',q:b.term,addressdetails:'1'},function(b){if(!b.length){a([{value:'',label:'there are no results'}]);return}a(b.map(function(a){var b={label:a.display_name,latitude:a.lat,longitude:a.lon,value:a.display_name};return typeof a.address!='undefined'&&(b.county=a.address.county),typeof a.address!='undefined'&&(b.city=a.address.city),typeof a.address!='undefined'&&(b.state=a.address.state),typeof a.address!='undefined'&&(b.country=a.address.country),typeof a.address!='undefined'&&(b.zip=a.address.postcode),typeof a.address!='undefined'&&(b.country_short=a.address.country_code),b}))},'json')},select:function(e,b){var c=b.item.latitude,d=b.item.longitude;a('#zip').val(b.item.zip),a('#countyState').val(b.item.county),a('#city').val(b.item.city),a('#homey_country').val(b.item.country),a('input[name="country_short"]').val(b.item.country_short),u(c,d),a('#city, #countyState, #area, #homey_country').selectpicker('refresh')}})},aH(),aJ=function(){return a('.infobox_trigger').each(function(b){a(this).on('mouseenter',function(){d[b].fire('click')}),a(this).on('mouseleave',function(){})}),!1},aS=function(){a('#find').on('click',function(c){c.preventDefault();var b=a('input[name="listing_address"]').val().replace(/\n/g,',').replace(/,,/g,',');if(!b)return;a.get('https://nominatim.openstreetmap.org/search',{format:'json',q:b,limit:1},function(a){if(a.length!==1)return;u(a[0].lat,a[0].lon)},'json')})},aS(),a(".homey_find_address_osm").click(function(){var b=a('input[name="listing_address"]').val().replace(/\n/g,',').replace(/,,/g,',');if(!b)return;a.get('https://nominatim.openstreetmap.org/search',{format:'json',q:b,limit:1},function(a){if(a.length!==1)return;u(a[0].lat,a[0].lon)},'json')}))})(jQuery)